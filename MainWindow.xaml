<Window x:Class="CrossfireCrosshair.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:CrossfireCrosshair.Controls"
        mc:Ignorable="d"
        Title="准星辅助工具"
        Height="760"
        Width="1120"
        MinHeight="680"
        MinWidth="980">
    <Grid Margin="14">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="315" />
            <ColumnDefinition Width="14" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>
            <GroupBox Header="配置档" Margin="0,0,0,10">
                <DockPanel Margin="8">
                    <StackPanel DockPanel.Dock="Bottom"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                Margin="0,8,0,0">
                        <Button Content="新增" Width="72" Margin="0,0,6,0" Click="AddProfile_Click" />
                        <Button Content="复制" Width="72" Margin="0,0,6,0" Click="DuplicateProfile_Click" />
                        <Button Content="删除" Width="72" Click="DeleteProfile_Click" />
                    </StackPanel>
                    <ListBox x:Name="ProfilesList"
                             MinHeight="250"
                             DisplayMemberPath="Name"
                             ItemsSource="{Binding Profiles}"
                             SelectedIndex="{Binding SelectedProfileIndex, Mode=TwoWay}" />
                </DockPanel>
            </GroupBox>

            <GroupBox Header="准星叠加" Margin="0,0,0,10">
                <StackPanel Margin="8">
                    <CheckBox Content="启用准星叠加"
                              IsChecked="{Binding OverlayEnabled, Mode=TwoWay}"
                              Margin="0,0,0,8" />
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="显示器：" VerticalAlignment="Center" />
                        <ComboBox Margin="8,0,0,0"
                                  Width="220"
                                  DisplayMemberPath="DisplayName"
                                  SelectedValuePath="Index"
                                  ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=AvailableMonitors}"
                                  SelectedValue="{Binding TargetMonitorIndex, Mode=TwoWay}" />
                    </StackPanel>
                    <WrapPanel Margin="0,0,0,8">
                        <Button Content="应用显示器" Width="120" Margin="0,0,8,0" Click="ApplyMonitor_Click" />
                        <Button Content="重置预设" Width="120" Click="ResetPresets_Click" />
                    </WrapPanel>
                    <TextBlock x:Name="StatusText" Foreground="{DynamicResource AppWarningBrush}" TextWrapping="Wrap" />
                </StackPanel>
            </GroupBox>

            <GroupBox Header="启动与托盘" Margin="0,0,0,10">
                <StackPanel Margin="8">
                    <CheckBox Content="开机自启动（当前用户）"
                              Margin="0,0,0,8"
                              IsChecked="{Binding StartWithWindows, Mode=TwoWay}" />
                    <CheckBox Content="最小化到系统托盘"
                              Margin="0,0,0,8"
                              IsChecked="{Binding MinimizeToTray, Mode=TwoWay}" />
                    <WrapPanel>
                        <Button Content="立即隐藏到托盘" Width="140" Click="HideToTray_Click" />
                    </WrapPanel>
                </StackPanel>
            </GroupBox>

            <GroupBox Header="分享码" Margin="0,0,0,10">
                <StackPanel Margin="8">
                    <WrapPanel Margin="0,0,0,8">
                        <Button Content="复制当前分享码" Width="132" Margin="0,0,8,0" Click="CopyShareCode_Click" />
                        <Button Content="从剪贴板导入" Width="132" Margin="0,0,8,0" Click="ImportShareCodeFromClipboard_Click" />
                        <Button Content="手动粘贴..." Width="96" Click="ImportShareCodeManual_Click" />
                    </WrapPanel>
                    <TextBlock x:Name="ShareCodeStatusText" TextWrapping="Wrap" Foreground="{DynamicResource AppMutedTextBrush}" />
                </StackPanel>
            </GroupBox>

            <GroupBox Header="全局热键">
                <StackPanel Margin="8">
                    <TextBlock Text="开关叠加" FontWeight="SemiBold" />
                    <WrapPanel Margin="0,4,0,8">
                        <CheckBox Content="Ctrl" Margin="0,0,8,0" IsChecked="{Binding ToggleOverlayHotkey.Ctrl, Mode=TwoWay}" />
                        <CheckBox Content="Alt" Margin="0,0,8,0" IsChecked="{Binding ToggleOverlayHotkey.Alt, Mode=TwoWay}" />
                        <CheckBox Content="Shift" Margin="0,0,8,0" IsChecked="{Binding ToggleOverlayHotkey.Shift, Mode=TwoWay}" />
                        <CheckBox Content="Win" Margin="0,0,8,0" IsChecked="{Binding ToggleOverlayHotkey.Win, Mode=TwoWay}" />
                        <ComboBox Width="92"
                                  ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=AvailableKeys}"
                                  SelectedItem="{Binding ToggleOverlayHotkey.Key, Mode=TwoWay}" />
                    </WrapPanel>

                    <TextBlock Text="轮换配置档" FontWeight="SemiBold" />
                    <WrapPanel Margin="0,4,0,8">
                        <CheckBox Content="Ctrl" Margin="0,0,8,0" IsChecked="{Binding CycleProfileHotkey.Ctrl, Mode=TwoWay}" />
                        <CheckBox Content="Alt" Margin="0,0,8,0" IsChecked="{Binding CycleProfileHotkey.Alt, Mode=TwoWay}" />
                        <CheckBox Content="Shift" Margin="0,0,8,0" IsChecked="{Binding CycleProfileHotkey.Shift, Mode=TwoWay}" />
                        <CheckBox Content="Win" Margin="0,0,8,0" IsChecked="{Binding CycleProfileHotkey.Win, Mode=TwoWay}" />
                        <ComboBox Width="92"
                                  ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=AvailableKeys}"
                                  SelectedItem="{Binding CycleProfileHotkey.Key, Mode=TwoWay}" />
                    </WrapPanel>

                    <Button Content="重新注册热键" Width="160" Click="ReregisterHotkeys_Click" />
                    <TextBlock x:Name="HotkeyText" Margin="0,8,0,0" TextWrapping="Wrap" />
                </StackPanel>
            </GroupBox>

            <GroupBox Header="安全说明" Margin="0,10,0,0">
                <TextBlock Margin="8"
                           TextWrapping="Wrap"
                           Text="本工具仅使用透明叠加层与全局热键，不注入游戏进程、不读取游戏内存、不安装驱动。" />
            </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <GroupBox Header="预览" Margin="0,0,0,10">
                    <Border Margin="8"
                            Padding="8"
                            CornerRadius="6"
                            Background="#121822">
                        <Grid MinHeight="330">
                            <controls:CrosshairPreviewControl Profile="{Binding ElementName=ProfilesList, Path=SelectedItem}" />
                        </Grid>
                    </Border>
                </GroupBox>

                <GroupBox Header="基础样式" Margin="0,0,0,10">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="56" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="配置名称" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 Grid.ColumnSpan="2"
                                 Margin="0,2,0,8"
                                 Text="{Binding ElementName=ProfilesList, Path=SelectedItem.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="线长" />
                        <Slider Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="0"
                                Maximum="30"
                                TickFrequency="0.5"
                                IsSnapToTickEnabled="False"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.LineLength, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="1"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.LineLength, StringFormat=F1}" />

                        <TextBlock Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Text="线宽" />
                        <Slider Grid.Row="2"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="0.5"
                                Maximum="8"
                                TickFrequency="0.1"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.LineThickness, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="2"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.LineThickness, StringFormat=F1}" />

                        <TextBlock Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Text="中心间隙" />
                        <Slider Grid.Row="3"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="-10"
                                Maximum="25"
                                TickFrequency="0.5"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.Gap, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="3"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.Gap, StringFormat=F1}" />

                        <TextBlock Grid.Row="4" Grid.Column="0" VerticalAlignment="Center" Text="中心点大小" />
                        <Slider Grid.Row="4"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="0"
                                Maximum="12"
                                TickFrequency="0.5"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.DotSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="4"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.DotSize, StringFormat=F1}" />

                        <TextBlock Grid.Row="5" Grid.Column="0" VerticalAlignment="Center" Text="描边厚度" />
                        <Slider Grid.Row="5"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="0"
                                Maximum="5"
                                TickFrequency="0.1"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.OutlineThickness, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="5"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.OutlineThickness, StringFormat=F1}" />

                        <TextBlock Grid.Row="6" Grid.Column="0" VerticalAlignment="Center" Text="水平偏移" />
                        <Slider Grid.Row="6"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="-120"
                                Maximum="120"
                                TickFrequency="1"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.OffsetX, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="6"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.OffsetX, StringFormat=F0}" />

                        <TextBlock Grid.Row="7" Grid.Column="0" VerticalAlignment="Center" Text="垂直偏移" />
                        <Slider Grid.Row="7"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="-120"
                                Maximum="120"
                                TickFrequency="1"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.OffsetY, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="7"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.OffsetY, StringFormat=F0}" />

                        <TextBlock Grid.Row="8" Grid.Column="0" VerticalAlignment="Center" Text="动态扩散" />
                        <Slider Grid.Row="8"
                                Grid.Column="1"
                                Margin="0,2,8,8"
                                Minimum="0"
                                Maximum="20"
                                TickFrequency="0.5"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.DynamicSpread, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="8"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.DynamicSpread, StringFormat=F1}" />

                        <TextBlock Grid.Row="9" Grid.Column="0" VerticalAlignment="Center" Text="不透明度" />
                        <Slider Grid.Row="9"
                                Grid.Column="1"
                                Margin="0,2,8,0"
                                Minimum="0.1"
                                Maximum="1.0"
                                TickFrequency="0.01"
                                Value="{Binding ElementName=ProfilesList, Path=SelectedItem.Opacity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock Grid.Row="9"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Text="{Binding ElementName=ProfilesList, Path=SelectedItem.Opacity, StringFormat=F2}" />
                    </Grid>
                </GroupBox>

                <GroupBox Header="显示规则" Margin="0,0,0,10">
                    <WrapPanel Margin="10">
                        <CheckBox Margin="0,0,16,8"
                                  Content="显示线条"
                                  IsChecked="{Binding ElementName=ProfilesList, Path=SelectedItem.ShowLines, Mode=TwoWay}" />
                        <CheckBox Margin="0,0,16,8"
                                  Content="显示中心点"
                                  IsChecked="{Binding ElementName=ProfilesList, Path=SelectedItem.ShowCenterDot, Mode=TwoWay}" />
                        <CheckBox Margin="0,0,16,8"
                                  Content="显示描边"
                                  IsChecked="{Binding ElementName=ProfilesList, Path=SelectedItem.ShowOutline, Mode=TwoWay}" />
                        <CheckBox Margin="0,0,16,8"
                                  Content="T 形准星（隐藏上方）"
                                  IsChecked="{Binding ElementName=ProfilesList, Path=SelectedItem.TStyle, Mode=TwoWay}" />
                    </WrapPanel>
                </GroupBox>

                <GroupBox Header="颜色">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="190" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="110" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="主颜色 (hex)" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 Margin="0,0,8,8"
                                 Text="{Binding ElementName=ProfilesList, Path=SelectedItem.ColorHex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <Button Grid.Row="0" Grid.Column="2" Margin="0,0,0,8" Content="选择..." Click="PickMainColor_Click" />

                        <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="描边颜色 (hex)" />
                        <TextBox Grid.Row="1"
                                 Grid.Column="1"
                                 Margin="0,0,8,0"
                                 Text="{Binding ElementName=ProfilesList, Path=SelectedItem.OutlineColorHex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <Button Grid.Row="1" Grid.Column="2" Content="选择..." Click="PickOutlineColor_Click" />
                    </Grid>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
